var lyricScroll=function(e){"use strict";var t={name:"LyricScroll",props:{currentTime:{type:Number,required:!0},lyric:{type:Object,required:!0},tLyric:Object,lyricActiveClass:String,lyricCenterClass:String,lyricScrollTime:{type:Number,default:400},dragendWaitTime:{type:Number,default:3e3},lyricMargin:{type:String,default:"20px"},lyricLineheight:{type:String,default:"1.5em"},triangleColor:{type:String,default:"orange"},triangleWidth:{type:String,default:"20px"},centerLineColor:{type:String,default:"#ccc"},centerTimeColor:{type:String,default:"orange"}},mounted:function(){this.nowTranslateY=this.lyricPadding},data:function(){return{startClientY:0,startTranslateY:0,isDragging:!1,nowTranslateY:0,timer:null,centerLyricIdx:-1}},computed:{allLyric:function(){var e=[];if("{}"!==JSON.stringify(this.tLyric))for(var t in this.lyric)e.push([Number(t),this.lyric[t],this.tLyric[t]]);else for(var i in this.lyric)e.push([Number(i),this.lyric[i]]);return e},wrapper:function(){return this.$refs.lyricWrapper},wrapperHeight:function(){return this.wrapper.offsetHeight},viewHeight:function(){return this.$refs.lyricView.offsetHeight},lastLyricHeight:function(){return this.wrapper.querySelector("div:last-child").offsetHeight},lyricPadding:function(){return.44*this.viewHeight},minTranslateY:function(){return-(this.wrapperHeight-this.lyricPadding-this.lastLyricHeight)},offsetTopList:function(){var e=[];return Array.from(this.wrapper.querySelectorAll("div")).forEach(function(t){setTimeout(function(){e.push(t.offsetTop)},0)}),e}},methods:{unitDivide:function(e,t){var i=parseFloat(e);return""+i/t+e.replace(i,"")},isActiveLyric:function(e){var t=this.allLyric[e][0],i=this.allLyric[e+1],r=this.currentTime;return t<=r&&i&&i[0]>r||t<=r&&!i},timeToStr:function(e){var t=(e=Math.round(e))%60,i=Math.floor(e/60);return t<10&&(t="0"+t),i<10&&(i="0"+i),i+":"+t},changeCurrentTime:function(){var e=this;this.$emit("change-current-time",this.allLyric[this.centerLyricIdx][0]),this.$nextTick(function(){e.isDragging=!1})},getTranslateY:function(e){var t=window.getComputedStyle(e);return(t.transform||t.webkitTransform).split(",")[5].replace(")","")},updateLyricPos:function(){if(!this.isDragging){var e=this.wrapper.querySelector("."+this.lyricActiveClass);if(e){var t=e.offsetTop-this.lyricPadding;this.nowTranslateY=-t}}},onTouchStart:function(e){this.isDragging=!0,clearTimeout(this.timer),this.startClientY=e.touches[0].clientY,this.startTranslateY=Number(this.getTranslateY(this.wrapper)),this.nowTranslateY=this.startTranslateY},onTouchMove:function(e){e.preventDefault();var t=e.touches[0].clientY,i=this.startTranslateY+t-this.startClientY;i>this.lyricPadding?this.nowTranslateY=this.lyricPadding:i<this.minTranslateY?this.nowTranslateY=this.minTranslateY:(this.nowTranslateY=i,this.centerLyricIdx=this.findCenterLyricIdx())},onTouchEnd:function(){var e=this;this.timer=setTimeout(function(){e.isDragging=!1,e.centerLyricIdx=-1},this.dragendWaitTime)},findCenterLyricIdx:function(){for(var e=this.viewHeight/2,t=this.offsetTopList,i=this.nowTranslateY,r=0,n=t.length;r<n;r++){if(i+t[r]<e&&t[r+1]&&i+t[r+1]>e||!t[r+1])return r}}},watch:{currentTime:function(){this.updateLyricPos()}}},i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"lyricView",staticClass:"lyric-view",on:{touchstart:e.onTouchStart,touchmove:e.onTouchMove,touchend:e.onTouchEnd}},[this.lyric?i("div",{ref:"lyricWrapper",staticClass:"lyric-wrapper",style:{transform:"translate3d(0, "+e.nowTranslateY+"px, 0)",transition:e.isDragging?"none":"all ease "+e.lyricScrollTime+"ms"}},e._l(e.allLyric,function(t,r){return i("div",{key:r,class:(n={},n[e.lyricCenterClass]=r===e.centerLyricIdx,n[e.lyricActiveClass]=e.isActiveLyric(r),n),style:{padding:e.unitDivide(e.lyricMargin,2)+" 0"}},[i("p",{style:{lineHeight:e.lyricLineheight}},[e._v(e._s(t[1]))]),e._v(" "),t[2]?i("p",{style:{lineHeight:e.lyricLineheight}},[e._v(e._s(t[2]))]):e._e()]);var n})):e._e(),e._v(" "),e.isDragging?i("div",{staticClass:"center-mark"},[i("div",{staticClass:"triangle",style:{borderColor:"transparent transparent transparent "+e.triangleColor,borderWidth:e.unitDivide(e.triangleWidth,1.732)+" 0 "+e.unitDivide(e.triangleWidth,1.732)+" "+e.triangleWidth},on:{click:e.changeCurrentTime}}),e._v(" "),i("div",{staticClass:"line",style:{background:e.centerLineColor}}),e._v(" "),i("div",{staticClass:"target-time",style:{color:e.centerTimeColor}},[e._v(e._s(e.allLyric[e.centerLyricIdx]&&e.timeToStr(e.allLyric[e.centerLyricIdx][0])))])]):e._e()])};i._withStripped=!0;var r=function(e,t,i,r,n,a,s,l){var c,o=("function"==typeof i?i.options:i)||{};if(o.__file="F:\\projects\\my-npm\\lyric-scroll\\src\\lyric-scroll.vue",o.render||(o.render=e.render,o.staticRenderFns=e.staticRenderFns,o._compiled=!0,n&&(o.functional=!0)),o._scopeId=r,t&&(c=function(e){t.call(this,s(e))}),void 0!==c)if(o.functional){var d=o.render;o.render=function(e,t){return c.call(t),d(e,t)}}else{var u=o.beforeCreate;o.beforeCreate=u?[].concat(u,c):[c]}return o}({render:i,staticRenderFns:[]},function(e){e&&e("data-v-19f89d32_0",{source:"\n.lyric-view[data-v-19f89d32] {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: relative;\n}\n.lyric-view .center-mark[data-v-19f89d32] {\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%);\n    height: 20px;\n    width: 100%;\n    display: flex;\n    align-items: center;\n}\n.lyric-view .center-mark .triangle[data-v-19f89d32] {\n      cursor: pointer;\n      border-style: solid;\n      margin-right: 10px;\n      margin-left: 10px;\n}\n.lyric-view .center-mark .line[data-v-19f89d32] {\n      flex: 1;\n      height: 1px;\n}\n.lyric-view .center-mark .target-time[data-v-19f89d32] {\n      padding: 0 10px;\n}\n.lyric-wrapper[data-v-19f89d32] {\n  transition: ease 0.3s;\n}\n.lyric-wrapper > div p[data-v-19f89d32] {\n    padding: 0;\n    margin: 0;\n}\n\n/*# sourceMappingURL=lyric-scroll.vue.map */",map:{version:3,sources:["F:\\projects\\my-npm\\lyric-scroll/F:\\projects\\my-npm\\lyric-scroll/F:\\projects\\my-npm\\lyric-scroll\\src\\lyric-scroll.vue","lyric-scroll.vue"],names:[],mappings:";AA8SA;EACA,YAAA;EACA,aAAA;EACA,iBAAA;EACA,mBAAA;CA4BA;AAhCA;IAMA,mBAAA;IACA,SAAA;IACA,4BAAA;IACA,aAAA;IACA,YAAA;IACA,cAAA;IACA,oBAAA;CAmBA;AA/BA;MAeA,gBAAA;MACA,oBAAA;MACA,mBAAA;MACA,kBAAA;CACA;AAnBA;MAuBA,QAAA;MACA,YAAA;CACA;AAzBA;MA6BA,gBAAA;CACA;AAGA;EACA,sBAAA;CAQA;AATA;IAKA,WAAA;IACA,UAAA;CACA;;ACxTA,4CAA4C",file:"lyric-scroll.vue",sourcesContent:[null,".lyric-view {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: relative; }\n  .lyric-view .center-mark {\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%);\n    height: 20px;\n    width: 100%;\n    display: flex;\n    align-items: center; }\n    .lyric-view .center-mark .triangle {\n      cursor: pointer;\n      border-style: solid;\n      margin-right: 10px;\n      margin-left: 10px; }\n    .lyric-view .center-mark .line {\n      flex: 1;\n      height: 1px; }\n    .lyric-view .center-mark .target-time {\n      padding: 0 10px; }\n\n.lyric-wrapper {\n  transition: ease 0.3s; }\n  .lyric-wrapper > div p {\n    padding: 0;\n    margin: 0; }\n\n/*# sourceMappingURL=lyric-scroll.vue.map */"]},media:void 0})},t,"data-v-19f89d32",!1,0,function e(){var t=document.head||document.getElementsByTagName("head")[0],i=e.styles||(e.styles={}),r="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(e,n){if(!document.querySelector('style[data-vue-ssr-id~="'+e+'"]')){var a=r?n.media||"default":e,s=i[a]||(i[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(e)){var l=n.source,c=s.ids.length;if(s.ids.push(e),r&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){var o=s.element=document.createElement("style");o.type="text/css",n.media&&o.setAttribute("media",n.media),r&&(o.setAttribute("data-group",a),o.setAttribute("data-next-index","0")),t.appendChild(o)}if(r&&(c=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",c+1)),s.element.styleSheet)s.parts.push(l),s.element.styleSheet.cssText=s.parts.filter(Boolean).join("\n");else{var d=document.createTextNode(l),u=s.element.childNodes;u[c]&&s.element.removeChild(u[c]),u.length?s.element.insertBefore(d,u[c]):s.element.appendChild(d)}}}}});return r.install=function(e){e.component(r.name,r)},"undefined"!=typeof window&&window.Vue&&window.Vue.use(r),e.default=r,e}({});
