var script={name:"LyricScroll",props:{currentTime:{type:Number,required:!0},lyric:{type:Object,required:!0},tLyric:{type:Object,default:function(){return null}},lyricActiveClass:String,lyricCenterClass:String,lyricScrollTime:{type:Number,default:400},dragendWaitTime:{type:Number,default:3e3},lyricMargin:{type:String,default:"20px"},lyricLineheight:{type:String,default:"1.5em"},triangleColor:{type:String,default:"orange"},triangleWidth:{type:String,default:"40px"},centerLineColor:{type:String,default:"#ccc"},centerTimeColor:{type:String,default:"orange"}},mounted:function(){this.nowTranslateY=this.lyricPadding},data:function(){return{startClientY:0,startTranslateY:0,isDragging:!1,nowTranslateY:0,timer:null,centerLyricIdx:-1}},computed:{allLyric:function(){var e=[];if(null!==this.tLyric)for(var t in this.lyric)e.push([Number(t),this.lyric[t],this.tLyric[t]]);else for(var i in this.lyric)e.push([Number(i),this.lyric[i]]);return e},perLyricHeight:function(){return this.wrapper.querySelector("div:first-child").offsetHeight},offsetTopList:function(){for(var e=[],t=this.perLyricHeight,i=this.wrapper.querySelectorAll("div").length,r=0;r<i;r++)e.push(r*t);return e},activeLyricIdx:function(){for(var e=this.allLyric,t=this.currentTime,i=0,r=e.length;i<r;i++)if(e[i][0]<t&&(e[i+1]&&e[i+1][0]>t||!e[i+1]))return i;return-1},wrapper:function(){return this.$refs.lyricWrapper},wrapperHeight:function(){return this.wrapper.offsetHeight},viewHeight:function(){return this.$refs.lyricView.offsetHeight},lyricPadding:function(){return this.viewHeight/2-this.perLyricHeight/2},minTranslateY:function(){return-(this.wrapperHeight-this.lyricPadding-this.perLyricHeight)}},methods:{unitDivide:function(e,t){var i=parseFloat(e);return""+i/t+e.replace(i,"")},timeToStr:function(e){var t=(e=Math.round(e))%60,i=Math.floor(e/60);return t<10&&(t="0"+t),i<10&&(i="0"+i),i+":"+t},changeCurrentTime:function(){var e=this;this.$emit("change-current-time",this.allLyric[this.centerLyricIdx][0]),this.$nextTick(function(){e.isDragging=!1})},getTranslateY:function(e){var t=window.getComputedStyle(e);return(t.transform||t.webkitTransform).split(",")[5].replace(")","")},updateLyricPos:function(){if(!this.isDragging){var e=this.offsetTopList[this.activeLyricIdx]-this.lyricPadding;this.nowTranslateY=-e}},onTouchStart:function(e){this.isDragging=!0,clearTimeout(this.timer),this.startClientY=e.touches[0].clientY,this.startTranslateY=Number(this.getTranslateY(this.wrapper)),this.nowTranslateY=this.startTranslateY},onTouchMove:function(e){e.preventDefault();var t=e.touches[0].clientY,i=this.startTranslateY+t-this.startClientY;i>this.lyricPadding?this.nowTranslateY=this.lyricPadding:i<this.minTranslateY?this.nowTranslateY=this.minTranslateY:(this.nowTranslateY=i,this.centerLyricIdx=this.findCenterLyricIdx())},onTouchEnd:function(){var e=this;this.timer=setTimeout(function(){e.isDragging=!1,e.centerLyricIdx=-1},this.dragendWaitTime)},findCenterLyricIdx:function(){for(var e=this.viewHeight/2,t=this.offsetTopList,i=this.nowTranslateY,r=0,n=t.length;r<n;r++){if(i+t[r]<e&&t[r+1]&&i+t[r+1]>e||!t[r+1])return r}}},watch:{currentTime:function(){this.updateLyricPos()}}},__vue_script__=script,__vue_render__=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"lyricView",staticClass:"lyric-view",on:{touchstart:e.onTouchStart,touchmove:e.onTouchMove,touchend:e.onTouchEnd}},[this.lyric?i("div",{ref:"lyricWrapper",staticClass:"lyric-wrapper",style:{transform:"translate3d(0, "+e.nowTranslateY+"px, 0)",transition:e.isDragging?"none":"all ease "+e.lyricScrollTime+"ms"}},e._l(e.allLyric,function(t,r){return i("div",{key:r,class:(n={},n[e.lyricCenterClass]=r===e.centerLyricIdx,n[e.lyricActiveClass]=r===e.activeLyricIdx,n),style:{padding:e.unitDivide(e.lyricMargin,2)+" 0"}},[i("p",{style:{lineHeight:e.lyricLineheight}},[e._v(e._s(t[1]))]),e._v(" "),t[2]?i("p",{style:{lineHeight:e.lyricLineheight}},[e._v(e._s(t[2]))]):e._e()]);var n})):e._e(),e._v(" "),e.isDragging?i("div",{staticClass:"center-mark"},[i("div",{staticClass:"triangle",style:{borderColor:"transparent transparent transparent "+e.triangleColor,borderWidth:e.unitDivide(e.triangleWidth,1.732)+" 0 "+e.unitDivide(e.triangleWidth,1.732)+" "+e.triangleWidth},on:{click:e.changeCurrentTime}}),e._v(" "),i("div",{staticClass:"line",style:{background:e.centerLineColor}}),e._v(" "),i("div",{staticClass:"target-time",style:{color:e.centerTimeColor}},[e._v(e._s(e.allLyric[e.centerLyricIdx]&&e.timeToStr(e.allLyric[e.centerLyricIdx][0])))])]):e._e()])},__vue_staticRenderFns__=[];__vue_render__._withStripped=!0;var __vue_inject_styles__=function(e){e&&e("data-v-11c872fc_0",{source:"\n.lyric-view[data-v-11c872fc] {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: relative;\n}\n.lyric-view .center-mark[data-v-11c872fc] {\n    box-sizing: border-box;\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%);\n    width: 100%;\n    display: flex;\n    align-items: center;\n}\n.lyric-view .center-mark .triangle[data-v-11c872fc] {\n      border-style: solid;\n}\n.lyric-view .center-mark .line[data-v-11c872fc] {\n      flex: 1;\n      height: 1px;\n      margin: 0 20px;\n}\n.lyric-wrapper[data-v-11c872fc] {\n  transition: ease 0.3s;\n}\n.lyric-wrapper > div p[data-v-11c872fc] {\n    padding: 0;\n    margin: 0;\n}\n\n/*# sourceMappingURL=lyric-scroll.vue.map */",map:{version:3,sources:["F:\\projects\\my-npm\\vue-lyric-scroll/F:\\projects\\my-npm\\vue-lyric-scroll/F:\\projects\\my-npm\\vue-lyric-scroll\\src\\lyric-scroll.vue","lyric-scroll.vue"],names:[],mappings:";AA2TA;EACA,YAAA;EACA,aAAA;EACA,iBAAA;EACA,mBAAA;CAqBA;AAzBA;IAMA,uBAAA;IACA,mBAAA;IACA,SAAA;IACA,4BAAA;IACA,YAAA;IACA,cAAA;IACA,oBAAA;CAYA;AAxBA;MAeA,oBAAA;CACA;AAhBA;MAoBA,QAAA;MACA,YAAA;MACA,eAAA;CACA;AAGA;EACA,sBAAA;CAMA;AAPA;IAIA,WAAA;IACA,UAAA;CACA;;ACjUA,4CAA4C",file:"lyric-scroll.vue",sourcesContent:[null,".lyric-view {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: relative; }\n  .lyric-view .center-mark {\n    box-sizing: border-box;\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%);\n    width: 100%;\n    display: flex;\n    align-items: center; }\n    .lyric-view .center-mark .triangle {\n      border-style: solid; }\n    .lyric-view .center-mark .line {\n      flex: 1;\n      height: 1px;\n      margin: 0 20px; }\n\n.lyric-wrapper {\n  transition: ease 0.3s; }\n  .lyric-wrapper > div p {\n    padding: 0;\n    margin: 0; }\n\n/*# sourceMappingURL=lyric-scroll.vue.map */"]},media:void 0})},__vue_scope_id__="data-v-11c872fc",__vue_module_identifier__=void 0,__vue_is_functional_template__=!1;function __vue_normalize__(e,t,i,r,n,a,s,c){var l,o=("function"==typeof i?i.options:i)||{};if(o.__file="F:\\projects\\my-npm\\vue-lyric-scroll\\src\\lyric-scroll.vue",o.render||(o.render=e.render,o.staticRenderFns=e.staticRenderFns,o._compiled=!0,n&&(o.functional=!0)),o._scopeId=r,t&&(l=function(e){t.call(this,s(e))}),void 0!==l)if(o.functional){var u=o.render;o.render=function(e,t){return l.call(t),u(e,t)}}else{var d=o.beforeCreate;o.beforeCreate=d?[].concat(d,l):[l]}return o}function __vue_create_injector__(){var e=document.head||document.getElementsByTagName("head")[0],t=__vue_create_injector__.styles||(__vue_create_injector__.styles={}),i="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,n){if(!document.querySelector('style[data-vue-ssr-id~="'+r+'"]')){var a=i?n.media||"default":r,s=t[a]||(t[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(r)){var c=n.source,l=s.ids.length;if(s.ids.push(r),i&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){var o=s.element=document.createElement("style");o.type="text/css",n.media&&o.setAttribute("media",n.media),i&&(o.setAttribute("data-group",a),o.setAttribute("data-next-index","0")),e.appendChild(o)}if(i&&(l=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",l+1)),s.element.styleSheet)s.parts.push(c),s.element.styleSheet.cssText=s.parts.filter(Boolean).join("\n");else{var u=document.createTextNode(c),d=s.element.childNodes;d[l]&&s.element.removeChild(d[l]),d.length?s.element.insertBefore(u,d[l]):s.element.appendChild(u)}}}}}var LyricScroll=__vue_normalize__({render:__vue_render__,staticRenderFns:__vue_staticRenderFns__},__vue_inject_styles__,__vue_script__,__vue_scope_id__,__vue_is_functional_template__,__vue_module_identifier__,__vue_create_injector__,void 0);LyricScroll.install=function(e){e.component(LyricScroll.name,LyricScroll)},"undefined"!=typeof window&&window.Vue&&window.Vue.use(LyricScroll);export default LyricScroll;
